-- Powerful Roblox Aimbot with Adjustable FOV
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")
local Camera = Workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

-- Create ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "AimbotGui"
ScreenGui.ResetOnSpawn = false
ScreenGui.IgnoreGuiInset = true
ScreenGui.DisplayOrder = 999

local success = pcall(function()
    ScreenGui.Parent = game:GetService("CoreGui")
end)

if not success then
    ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
end

-- Create Main Frame (bigger for slider)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 220, 0, 150)
MainFrame.Position = UDim2.new(0.5, -110, 0.1, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

local Corner = Instance.new("UICorner")
Corner.CornerRadius = UDim.new(0, 12)
Corner.Parent = MainFrame

-- Title
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 35)
Title.BackgroundTransparency = 1
Title.Text = "AIMBOT"
Title.TextColor3 = Color3.fromRGB(0, 0, 0)
Title.TextSize = 16
Title.Font = Enum.Font.GothamBold
Title.Parent = MainFrame

-- Status Label
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, -20, 0, 20)
StatusLabel.Position = UDim2.new(0, 10, 0, 40)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "Status: OFF"
StatusLabel.TextColor3 = Color3.fromRGB(0, 0, 0)
StatusLabel.TextSize = 13
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
StatusLabel.Parent = MainFrame

-- FOV Size Label
local FOVLabel = Instance.new("TextLabel")
FOVLabel.Size = UDim2.new(1, -20, 0, 20)
FOVLabel.Position = UDim2.new(0, 10, 0, 65)
FOVLabel.BackgroundTransparency = 1
FOVLabel.Text = "FOV Size: 75"
FOVLabel.TextColor3 = Color3.fromRGB(0, 0, 0)
FOVLabel.TextSize = 12
FOVLabel.Font = Enum.Font.Gotham
FOVLabel.TextXAlignment = Enum.TextXAlignment.Left
FOVLabel.Parent = MainFrame

-- Slider Background
local SliderBG = Instance.new("Frame")
SliderBG.Size = UDim2.new(0, 190, 0, 6)
SliderBG.Position = UDim2.new(0, 15, 0, 90)
SliderBG.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
SliderBG.BorderSizePixel = 0
SliderBG.Parent = MainFrame

local SliderBGCorner = Instance.new("UICorner")
SliderBGCorner.CornerRadius = UDim.new(1, 0)
SliderBGCorner.Parent = SliderBG

-- Slider Fill
local SliderFill = Instance.new("Frame")
SliderFill.Size = UDim2.new(0.5, 0, 1, 0)
SliderFill.BackgroundColor3 = Color3.fromRGB(100, 220, 100)
SliderFill.BorderSizePixel = 0
SliderFill.Parent = SliderBG

local SliderFillCorner = Instance.new("UICorner")
SliderFillCorner.CornerRadius = UDim.new(1, 0)
SliderFillCorner.Parent = SliderFill

-- Slider Button
local SliderButton = Instance.new("TextButton")
SliderButton.Size = UDim2.new(0, 16, 0, 16)
SliderButton.Position = UDim2.new(0.5, -8, 0.5, -8)
SliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
SliderButton.Text = ""
SliderButton.BorderSizePixel = 0
SliderButton.Parent = SliderBG

local SliderButtonCorner = Instance.new("UICorner")
SliderButtonCorner.CornerRadius = UDim.new(1, 0)
SliderButtonCorner.Parent = SliderButton

local SliderButtonStroke = Instance.new("UIStroke")
SliderButtonStroke.Color = Color3.fromRGB(100, 100, 100)
SliderButtonStroke.Thickness = 2
SliderButtonStroke.Parent = SliderButton

-- Toggle Container
local ToggleContainer = Instance.new("Frame")
ToggleContainer.Size = UDim2.new(0, 100, 0, 40)
ToggleContainer.Position = UDim2.new(0, 15, 1, -45)
ToggleContainer.BackgroundTransparency = 1
ToggleContainer.Parent = MainFrame

-- Toggle Button
local ToggleButton = Instance.new("TextButton")
ToggleButton.Name = "ToggleButton"
ToggleButton.Size = UDim2.new(0, 50, 0, 28)
ToggleButton.Position = UDim2.new(0, 0, 0.5, -14)
ToggleButton.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
ToggleButton.Text = ""
ToggleButton.BorderSizePixel = 0
ToggleButton.Parent = ToggleContainer

local ToggleCorner = Instance.new("UICorner")
ToggleCorner.CornerRadius = UDim.new(1, 0)
ToggleCorner.Parent = ToggleButton

-- Toggle Circle
local ToggleCircle = Instance.new("Frame")
ToggleCircle.Name = "Circle"
ToggleCircle.Size = UDim2.new(0, 22, 0, 22)
ToggleCircle.Position = UDim2.new(0, 3, 0.5, -11)
ToggleCircle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
ToggleCircle.BorderSizePixel = 0
ToggleCircle.Parent = ToggleButton

local CircleCorner = Instance.new("UICorner")
CircleCorner.CornerRadius = UDim.new(1, 0)
CircleCorner.Parent = ToggleCircle

-- Close Button
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 25, 0, 25)
CloseButton.Position = UDim2.new(1, -30, 0, 5)
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
CloseButton.Text = "Ã—"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 18
CloseButton.Font = Enum.Font.GothamBold
CloseButton.BorderSizePixel = 0
CloseButton.Parent = MainFrame

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(1, 0)
CloseCorner.Parent = CloseButton

-- FOV Circle
local FOVCircle = Instance.new("Frame")
FOVCircle.Name = "FOVCircle"
FOVCircle.Size = UDim2.new(0, 150, 0, 150)
FOVCircle.Position = UDim2.new(0.5, -75, 0.5, -75)
FOVCircle.BackgroundTransparency = 1
FOVCircle.Visible = false
FOVCircle.Parent = ScreenGui

local CircleStroke = Instance.new("UIStroke")
CircleStroke.Color = Color3.fromRGB(255, 255, 255)
CircleStroke.Thickness = 2
CircleStroke.Transparency = 0.5
CircleStroke.Parent = FOVCircle

local CircleUICorner = Instance.new("UICorner")
CircleUICorner.CornerRadius = UDim.new(1, 0)
CircleUICorner.Parent = FOVCircle

-- Center Dot
local CenterDot = Instance.new("Frame")
CenterDot.Name = "CenterDot"
CenterDot.Size = UDim2.new(0, 6, 0, 6)
CenterDot.Position = UDim2.new(0.5, -3, 0.5, -3)
CenterDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
CenterDot.BorderSizePixel = 0
CenterDot.Parent = FOVCircle

local DotCorner = Instance.new("UICorner")
DotCorner.CornerRadius = UDim.new(1, 0)
DotCorner.Parent = CenterDot

-- Lock Indicator
local LockIndicator = Instance.new("Frame")
LockIndicator.Name = "LockIndicator"
LockIndicator.Size = UDim2.new(0, 50, 0, 50)
LockIndicator.Position = UDim2.new(0.5, -25, 0.5, -25)
LockIndicator.BackgroundTransparency = 1
LockIndicator.Visible = false
LockIndicator.Parent = ScreenGui

local LockStroke = Instance.new("UIStroke")
LockStroke.Color = Color3.fromRGB(255, 50, 50)
LockStroke.Thickness = 4
LockStroke.Parent = LockIndicator

local LockUICorner = Instance.new("UICorner")
LockUICorner.CornerRadius = UDim.new(1, 0)
LockUICorner.Parent = LockIndicator

-- Variables
local aimbotEnabled = false
local isRightClicking = false
local FOVRadius = 75
local targetPart = "Head"
local currentTarget = nil
local isLocked = false

-- Slider Variables
local draggingSlider = false
local minFOV = 25
local maxFOV = 300

-- Get Mouse
local mouse = LocalPlayer:GetMouse()

-- Slider Functions
local function updateFOVSize(value)
    -- value is between 0 and 1
    FOVRadius = math.floor(minFOV + (maxFOV - minFOV) * value)
    FOVLabel.Text = "FOV Size: " .. FOVRadius
    
    -- Update circle size
    local circleSize = FOVRadius * 2
    FOVCircle.Size = UDim2.new(0, circleSize, 0, circleSize)
    FOVCircle.Position = UDim2.new(0.5, -FOVRadius, 0.5, -FOVRadius)
    
    -- Update slider fill
    SliderFill.Size = UDim2.new(value, 0, 1, 0)
    
    -- Update slider button position
    SliderButton.Position = UDim2.new(value, -8, 0.5, -8)
end

-- Slider Dragging
SliderButton.MouseButton1Down:Connect(function()
    draggingSlider = true
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingSlider = false
    end
end)

RunService.RenderStepped:Connect(function()
    if draggingSlider then
        local mouseX = UserInputService:GetMouseLocation()
        local sliderPos = SliderBG.AbsolutePosition.X
        local sliderSize = SliderBG.AbsoluteSize.X
        
        local relativeX = mouseX - sliderPos
        local value = math.clamp(relativeX / sliderSize, 0, 1)
        
        updateFOVSize(value)
    end
end)

-- Click on slider background to jump
SliderBG.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        local mouseX = input.Position.X
        local sliderPos = SliderBG.AbsolutePosition.X
        local sliderSize = SliderBG.AbsoluteSize.X
        
        local relativeX = mouseX - sliderPos
        local value = math.clamp(relativeX / sliderSize, 0, 1)
        
        updateFOVSize(value)
        draggingSlider = true
    end
end)

-- Initialize slider at 50%
updateFOVSize(0.5)

-- Functions
local function getClosestPlayerInFOV()
    local closestPlayer = nil
    local shortestDistance = FOVRadius
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local character = player.Character
            local head = character:FindFirstChild(targetPart)
            
            if head and character:FindFirstChild("Humanoid") and character.Humanoid.Health > 0 then
                local screenPos, onScreen = Camera:WorldToViewportPoint(head.Position)
                
                if onScreen and screenPos.Z > 0 then
                    local mousePos = UserInputService:GetMouseLocation()
                    local distance = (Vector2.new(screenPos.X, screenPos.Y) - mousePos).Magnitude
                    
                    if distance < shortestDistance then
                        closestPlayer = player
                        shortestDistance = distance
                    end
                end
            end
        end
    end
    
    return closestPlayer
end

local function lockOnTarget(target)
    if not target or not target.Character then return end
    
    local head = target.Character:FindFirstChild(targetPart)
    if not head then return end
    
    local headPos = head.Position
    local camPos = Camera.CFrame.Position
    
    Camera.CFrame = CFrame.new(camPos, headPos)
end

local function updateLockIndicator(target)
    if target and target.Character then
        local head = target.Character:FindFirstChild(targetPart)
        if head then
            local screenPos, onScreen = Camera:WorldToViewportPoint(head.Position)
            if onScreen and screenPos.Z > 0 then
                LockIndicator.Position = UDim2.new(0, screenPos.X - 25, 0, screenPos.Y - 25)
                LockIndicator.Visible = true
                return true
            end
        end
    end
    LockIndicator.Visible = false
    return false
end

-- Aimbot Loop
local aimbotConnection = nil

local function startAimbot()
    if aimbotConnection then return end
    
    aimbotConnection = RunService.RenderStepped:Connect(function()
        if aimbotEnabled and isRightClicking then
            if not currentTarget or not currentTarget.Character or not currentTarget.Character:FindFirstChild("Humanoid") or currentTarget.Character.Humanoid.Health <= 0 then
                currentTarget = getClosestPlayerInFOV()
            end
            
            if currentTarget and currentTarget.Character and currentTarget.Character:FindFirstChild(targetPart) then
                local head = currentTarget.Character:FindFirstChild(targetPart)
                if head then
                    local headPos = head.Position
                    local camPos = Camera.CFrame.Position
                    
                    for i = 1, 10 do
                        Camera.CFrame = CFrame.new(camPos, headPos)
                    end
                end
                
                if updateLockIndicator(currentTarget) then
                    isLocked = true
                    CircleStroke.Color = Color3.fromRGB(255, 50, 50)
                    CenterDot.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
                else
                    isLocked = false
                    currentTarget = nil
                end
            else
                isLocked = false
                LockIndicator.Visible = false
                CircleStroke.Color = Color3.fromRGB(255, 255, 255)
                CenterDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            end
        else
            currentTarget = nil
            isLocked = false
            LockIndicator.Visible = false
            CircleStroke.Color = Color3.fromRGB(255, 255, 255)
            CenterDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        end
    end)
end

local function stopAimbot()
    if aimbotConnection then
        aimbotConnection:Disconnect()
        aimbotConnection = nil
    end
    currentTarget = nil
    isLocked = false
    LockIndicator.Visible = false
end

-- Toggle Button
ToggleButton.MouseButton1Click:Connect(function()
    aimbotEnabled = not aimbotEnabled
    
    local tweenInfo = TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    if aimbotEnabled then
        StatusLabel.Text = "Status: ON"
        StatusLabel.TextColor3 = Color3.fromRGB(100, 220, 100)
        FOVCircle.Visible = true
        startAimbot()
        
        local colorTween = TweenService:Create(ToggleButton, tweenInfo, {BackgroundColor3 = Color3.fromRGB(100, 220, 100)})
        local positionTween = TweenService:Create(ToggleCircle, tweenInfo, {Position = UDim2.new(1, -25, 0.5, -11)})
        colorTween:Play()
        positionTween:Play()
    else
        StatusLabel.Text = "Status: OFF"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        FOVCircle.Visible = false
        stopAimbot()
        
        local colorTween = TweenService:Create(ToggleButton, tweenInfo, {BackgroundColor3 = Color3.fromRGB(200, 200, 200)})
        local positionTween = TweenService:Create(ToggleCircle, tweenInfo, {Position = UDim2.new(0, 3, 0.5, -11)})
        colorTween:Play()
        positionTween:Play()
    end
end)

-- Close Button
CloseButton.MouseButton1Click:Connect(function()
    stopAimbot()
    ScreenGui:Destroy()
end)

-- Update FOV Circle
RunService.RenderStepped:Connect(function()
    if FOVCircle.Visible then
        local mousePos = UserInputService:GetMouseLocation()
        FOVCircle.Position = UDim2.new(0, mousePos.X - FOVRadius, 0, mousePos.Y - FOVRadius)
    end
end)

-- Right Click Detection
UserInputService.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton2 and aimbotEnabled then
        isRightClicking = true
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton2 then
        isRightClicking = false
    end
end)

mouse.Button2Down:Connect(function()
    if aimbotEnabled then
        isRightClicking = true
    end
end)

mouse.Button2Up:Connect(function()
    isRightClicking = false
end)
